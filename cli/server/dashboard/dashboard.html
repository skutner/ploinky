<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ploinky Dashboard</title>
  <link rel="stylesheet" href="__ASSET_BASE__/dashboard.css" />
  <style>
    .wa-header-with-tabs {
      display: flex;
      flex-direction: column;
      background: var(--wa-bg-panel);
      border-bottom: 1px solid var(--wa-border);
    }
    
    .wa-header-top {
      display: flex;
      align-items: center;
      height: var(--wa-header-height);
      padding: 0 16px;
    }
    
    .wa-header-tabs {
      display: flex;
      padding: 0 16px;
      gap: 24px;
      border-top: 1px solid var(--wa-border);
    }
    
    .wa-header-tab {
      padding: 12px 0;
      color: var(--wa-text-secondary);
      cursor: pointer;
      position: relative;
      font-size: 14px;
      font-weight: 500;
      transition: color 0.2s;
    }
    
    .wa-header-tab:hover {
      color: var(--wa-text-primary);
    }
    
    .wa-header-tab.active {
      color: var(--wa-accent);
    }
    
    .wa-header-tab.active::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--wa-accent);
    }
    
    .wa-dashboard-container {
      height: calc(100vh - var(--wa-header-height) - 49px);
      background: var(--wa-bg-primary);
      overflow-y: auto;
    }
    
    .wa-dashboard-view {
      padding: 20px;
      display: none;
    }
    
    .wa-dashboard-view.active {
      display: block;
    }
    
    .wa-dashboard-card {
      background: var(--wa-bg-panel);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      border: 1px solid var(--wa-border);
    }
    
    .wa-dashboard-card-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--wa-text-secondary);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .wa-dashboard-pre {
      background: var(--wa-bg-primary);
      border: 1px solid var(--wa-border);
      border-radius: 6px;
      padding: 12px;
      color: var(--wa-text-primary);
      font-family: 'Menlo', 'Monaco', 'Consolas', monospace;
      font-size: 13px;
      line-height: 1.5;
      white-space: pre-wrap;
      word-wrap: break-word;
      margin: 0;
    }
    
    .wa-dashboard-actions {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    
    .wa-dashboard-btn {
      padding: 8px 16px;
      background: var(--wa-accent);
      color: white;
      border: none;
      border-radius: 24px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .wa-dashboard-btn:hover {
      background: var(--wa-accent-hover);
    }
    
    .wa-dashboard-input {
      padding: 8px 12px;
      background: var(--wa-bg-input);
      color: var(--wa-text-primary);
      border: 1px solid var(--wa-border);
      border-radius: 8px;
      font-size: 14px;
      outline: none;
    }
    
    .wa-agent-item {
      display: flex;
      align-items: center;
      padding: 12px;
      background: var(--wa-bg-primary);
      border: 1px solid var(--wa-border);
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: background 0.15s;
    }
    
    .wa-agent-item:hover {
      background: var(--wa-bg-hover);
    }
    
    .wa-agent-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--wa-accent);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 12px;
      font-size: 18px;
    }
    
    .wa-agent-info {
      flex: 1;
    }
    
    .wa-agent-name {
      font-size: 15px;
      color: var(--wa-text-primary);
      margin-bottom: 2px;
    }
    
    .wa-agent-status {
      font-size: 13px;
      color: var(--wa-text-secondary);
    }
    
    .wa-agent-actions {
      display: flex;
      gap: 8px;
    }
    
    .wa-agent-btn {
      padding: 6px 12px;
      background: transparent;
      color: var(--wa-accent);
      border: 1px solid var(--wa-accent);
      border-radius: 16px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .wa-agent-btn:hover {
      background: var(--wa-accent);
      color: white;
    }
  </style>
</head>
<body data-page="dashboard" data-theme="light" data-agent="__AGENT_NAME__" data-container="__CONTAINER_NAME__" data-runtime="__RUNTIME__" data-auth="__REQUIRES_AUTH__" data-base="__BASE_PATH__">
  <div class="wa-header-with-tabs">
    <div class="wa-header-top">
      <div class="wa-header-avatar">
        <span>ðŸ“Š</span>
      </div>
      <div class="wa-header-info">
        <div class="wa-header-title" id="titleBar">Dashboard</div>
        <div class="wa-header-status">
          <span class="wa-status-dot online"></span>
          <span id="status">ready</span>
        </div>
      </div>
      <div class="wa-header-actions">
        <a class="wa-icon-btn" id="lnkConsole" href="#" target="_blank" rel="noopener" title="Open Console">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 19V7H4v12h16m0-16c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h16m-7 14v-2h5v2h-5m-3.42-4L5.57 9H8.4l3.3 3.3c.39.39.39 1.03 0 1.42L8.42 17H5.59l3.99-4z"/>
          </svg>
        </a>
        <a class="wa-icon-btn" id="lnkChat" href="#" target="_blank" rel="noopener" title="Open Chat">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
          </svg>
        </a>
        <button class="wa-icon-btn" id="themeToggle" title="Toggle theme">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4z"/>
            <path d="M13 4h-2v-2h2v2zm0 18h-2v-2h2v2zm9-11h-2v-2h2v2zm-18 0h-2v-2h2v2z"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="wa-header-tabs">
      <div class="wa-header-tab active" data-tab="status">Status</div>
      <div class="wa-header-tab" data-tab="logs">Logs</div>
      <div class="wa-header-tab" data-tab="agents">Agents</div>
      <div class="wa-header-tab" data-tab="control">Control</div>
    </div>
  </div>

  <div class="wa-dashboard-container">
    <div id="view-status" class="wa-dashboard-view active">
      <div class="wa-dashboard-actions">
        <button class="wa-dashboard-btn" id="refreshStatus">Refresh Status</button>
      </div>
      <div class="wa-dashboard-card">
        <div class="wa-dashboard-card-title">System Status</div>
        <pre class="wa-dashboard-pre" id="statusOut">Loadingâ€¦</pre>
      </div>
    </div>

    <div id="view-logs" class="wa-dashboard-view">
      <div class="wa-dashboard-actions">
        <span style="display: flex; align-items: center; gap: 8px;">
          <label style="color: var(--wa-text-secondary); font-size: 14px;">Last</label>
          <input class="wa-dashboard-input" id="logCount" type="number" value="200" style="width: 80px"/>
          <label style="color: var(--wa-text-secondary); font-size: 14px;">lines</label>
        </span>
      </div>
      <div class="wa-dashboard-card">
        <div class="wa-dashboard-card-title">System Logs</div>
        <pre class="wa-dashboard-pre" id="logsOut">Loadingâ€¦</pre>
      </div>
    </div>

    <div id="view-agents" class="wa-dashboard-view">
      <div class="wa-dashboard-actions">
        <button class="wa-dashboard-btn" id="refreshAgents">Refresh Agents</button>
        <button class="wa-dashboard-btn" id="debugBtn" style="margin-left:8px">Debug Agent</button>
      </div>
      <div class="wa-dashboard-card">
        <div class="wa-dashboard-card-title">Active Agents</div>
        <div id="agentsList"></div>
      </div>
    </div>

    <div id="view-control" class="wa-dashboard-view">
      <div class="wa-dashboard-actions">
        <button class="wa-dashboard-btn" id="restartBtn" style="background: #f15c6d;">Restart System</button>
      </div>
      <div class="wa-dashboard-card">
        <div class="wa-dashboard-card-title">Control Output</div>
        <pre class="wa-dashboard-pre" id="ctrlOut">Ready for commands</pre>
      </div>
    </div>
  </div>

  <!-- Debug Popup -->
  <div id="debugPopup" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:100;">
    <div style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width:min(800px, 90vw); max-height:80vh; background:var(--wa-bg-panel); border:1px solid var(--wa-border); border-radius:12px; padding:20px; display:flex; flex-direction:column;">
      <h3 style="margin:0 0 16px 0; color:var(--wa-text-primary)">Debug Agent API</h3>

      <div style="display:flex; gap:12px; margin-bottom:12px;">
        <input type="text" id="debugAgentName" placeholder="Agent name" style="flex:1; padding:8px; border:1px solid var(--wa-border); border-radius:6px; background:var(--wa-bg-input); color:var(--wa-text-primary)">
        <input type="number" id="debugAgentPort" placeholder="Port (optional)" style="width:120px; padding:8px; border:1px solid var(--wa-border); border-radius:6px; background:var(--wa-bg-input); color:var(--wa-text-primary)">
      </div>

      <textarea id="debugJson" style="flex:1; min-height:300px; padding:12px; border:1px solid var(--wa-border); border-radius:6px; background:var(--wa-bg-input); color:var(--wa-text-primary); font-family:monospace; font-size:13px; resize:vertical;">{
  "action": "test",
  "data": "your data here"
}</textarea>

      <div id="debugError" style="color:var(--wa-danger); margin-top:8px; min-height:20px;"></div>

      <div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end;">
        <button id="debugSend" style="padding:8px 16px; background:var(--wa-accent); color:white; border:none; border-radius:6px; cursor:pointer;">Send</button>
        <button id="debugClose" style="padding:8px 16px; background:var(--wa-bg-hover); color:var(--wa-text-primary); border:1px solid var(--wa-border); border-radius:6px; cursor:pointer;">Close</button>
      </div>

      <div id="debugResponse" style="margin-top:16px; padding:12px; border:1px solid var(--wa-border); border-radius:6px; background:var(--wa-bg-primary); color:var(--wa-text-secondary); font-family:monospace; font-size:12px; max-height:200px; overflow-y:auto; display:none;">
      </div>
    </div>
  </div>

  <script src="__ASSET_BASE__/dashboard.js"></script>
</body>
</html>
